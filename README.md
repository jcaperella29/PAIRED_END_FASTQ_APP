# PAIRED_END_FASTQ_APP
A Shiny app for processing FASTQ file and producing files need for downstream analysis


JCAP Paired_End FASTQ Processing App

Summary of the  Functions of this App 
The app performs the following functions.
•	It  will read in your FASTQ files. It can then  demultiplex those files if a csv file containing the barcodes is provided. The demultiplexed files can be uploaded to the app to be  used as an input. 
•	The app can also  generate a summary of those files giving the number of reads, the average quality of those reads, and the percentage of those reads that have a read quality higher than a quality threshold set by the user  via a slider. 
•	The app can also filter out reads that are below that  threshold. The filtered FASTQs can be uploaded and used as an input. 
•	The application can also take a genome FASTA and use it to prepare a gene index.
•	 The app can prepare  a BAM file by aligning the FASTQs  to the  genome index. The app can then take the BAM file and convert it into  a BED file. 
•	The BAM file can also be used to prepare a counts matrix if a GTF file and a sample name is provided. 
•	The app can generate a GFF3 file and a FAI file using your GTF and genome FASTA files, respectively.
Note
Please be aware that the summary generation, filtering, and BAM file making steps have an input priority. That is, the BAM file making, and summary generation functions will first look for files in the filtered files slot. If there is nothing there, then the functions will check the demultiplexed files slot and  if that slot is also empty then the original FASTQs slot. The filtering function will look in the demultiplexed files slot first and then the original FASTQ files slot if the previously mentioned slot is empty. 
Prerequisites
1.You need your two paired end FASTQ files. 
2. You need to have an accessible file containing your sample name information. 
Please be aware that the program  assumes that your FASTQs come from the same sample. 
3. YOU need  a genome FASTA file.
4.IF you want to demultiplex, you need a csv file containing your barcodes. 
5.You need a GTF file. 

Mechanics/How to Use 
Inputs and Main Functions 
1.On the top of the side bar, you will see a button that says, “Set Working Directory.” Clicking this button will allow you to select the directory in which files generated by the application will appear. Note: you cannot select folders within folders using this button. You will receive a notification regarding which directory you have chosen.
2.Beneath that button, you will see two file browse buttons that say “Upload FASTQ file 1 “ and “Upload FASTQ file 2” respectively. Use these buttons to upload your original raw FASTQ files. You will receive a notification when the files are uploaded.
3.Beneath those buttons you will see a dropdown menu allowing you to select which sequencing machine you used. This is important since it affects the Phred quality score calculation. The current options are:  "Illumina/Sanger (Phred+33)" and "Solexa (Phred+64)". If users inform me of more options to add, then I will do so.
4.Beneath that  dropdown menu,  you will see a  text input labeled as “Name of Sample” allowing you to give the name of the sample that your FASTQs files were generated from.
5.Beneath that text input you will see a button labeled ”Upload Barcode File (Optional).” Use this button to upload your barcode information as a csv file. Note: this is only necessary if you plan to demultiplex your FASTQ files. 
6.Beneath that button you will see a button labeled “Run Demultiplexing.” If you click on this button after uploading the FASTQs and the barcode files, the application will demultiplex your FASTQs. The demultiplexed FASTQs will appear in your working directory. The files will be called “demultiplexed_ATCGGA.fastq"and “demultiplexed_GCTAGA.fastq" respectively with a date and time as a prefix. 
7. Beneath that button you will see two buttons  labeled  “Upload Demultiplexed File 1” and “Upload Demultiplexed File 2.” They will allow you to upload your demultiplexed FASTQs for further work by the app.
8. Beneath those two buttons there is a button called “Generate FASTQ Summary.” This button will take your FASTQs (either the ones uploaded in step 2, step 7 or step 11)  and will create a table with the names of your files, the number of reads in each file (“NumReads”), the percent of the reads that have a quality above the threshold mentioned in the slider further down the app’s side bar (“PrecentAboveThreshold”), and the average quality of the reads in the FASTQs (“AvgQuality”). The table will appear in the FASTQ Summary tab, and you will see a notification telling you when the process of making this table has started and is finished. This table can be downloaded via the “Download Summary as CSV” button directly below the “Generate FASTQ Summary” button. 
9. Beneath the “Download Summary as CSV” button there is a slide, “Quality Threshold” that allows the user to decide  how good of a quality score is acceptable for their reads. Regenerating the summary table after adjusting this slider will cause the app to use the newly generated “PrecentAboveThreshold” column to be based on the selected threshold. This threshold will also be used in the next step.
10.Beneath the slider, there is a button labeled “Filter Reads Below Quality Threshold.” Clicking this button  after uploading FASTQs in steps 2 or 7 will result in two new FASTQs being created in your selected working directory. They will be named as “filtered” and noted with the date and time that they were made.
11.Beneath that button,  there are two buttons to upload the filtered FASTQs. They are labeled as  “Upload Filtered FASTQ 1  (Optional)” and “Upload Filtered FASTQ 2 (Optional)” respectively. If  files are uploaded here they will be used for the alignment step later.
12. Beneath that is a button allowing the user to upload a FASTA file of the genome that relates to your FASTQs. It is labeled “Upload Genome File for Indexing.” Further down the sidebar is the numerical input called “Memory Allocation (MB)” which tells the app how much memory to use when making your index. Beneath that, there is a text input to determine the base name of your index, which is labeled as “Index Base Name for Alignment (e.g., hg38_index).”
13. After you  have provided the file and information mentioned in step 12, you can click a button called “Create Genome Index” to make your index. You will get a notification when the process starts and when it is done. This process can take up to two hours depending on how large your genome is. 
14.Once that process is done, you can click the button labeled “Align  FASTQs to Genome.” This button is to the right of the “Create Genome Index” button. It will create a BAM file from your genome index and FASTQs labeled with date and time that it was made  to appear in your selected working directory . You will get a notification when the process  starts and is finished.

15. Beneath that button you will see a button, “Upload BAM File” allowing you to upload your new BAM file to the app. The button following that one labeled as “Convert BAM to BED” will convert your BAM file into a BED file that will appear in your working directory and be labeled with the date and time that it was made. 
16.Below that button, is a button “Identify GTF Attributes.” This will allow the user to see what attributes can be used for annotation via the GTF. The list of attributes will be displayed in the  “GTF Attributes” tab.
17.Underneath that button is a file browse button labeled “Upload GTF File.” This allows you to upload a GTF file that relates to your genome of interest. This file and your BAM file will  be used by the next button “ Generate Counts Matrix”  to prepare a counts matrix complete with the name of your sample as the column name. The matrix will be displayed in the  “Counts Matrix” tab. The matrix can be downloaded via the “Download Counts Matrix” button which is to the right of the “Generate Counts Matrix” button. Note:  the ”Download Counts Matrix” button will not work unless you have prepared the counts matrix first.
18. The last two buttons are beneath the “Generate Counts Matrix” and “Download Counts Matrix” buttons. These buttons allow you to make an FAI file from your genome FASTA file and a GFF3 file from your GTF file, respectively. They are labeled as “Generate FAI” and “Generate GFF3” respectively. They will be labeled with the date and time that they were made. A notification will appear letting you know when the process is started and completed. 
19. This  README file will be displayed in the “README” tab.

